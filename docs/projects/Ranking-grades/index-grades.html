<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="DTK">
<meta name="dcterms.date" content="2025-04-08">

<title>Ranking by grade – MOSAIC Calc 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-d045e70ebd9269c25e164ecdb4898f56.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/live-runtime/live-runtime.js" type="module"></script>
<link href="../../site_libs/quarto-contrib/live-runtime/live-runtime.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="module" src="../../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">MOSAIC Calc 2025</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../mosaic.html"> 
<span class="menu-text">Mosaic?</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../basics.html"> 
<span class="menu-text">Basics</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../notes.html"> 
<span class="menu-text">Class notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../assignments.html"> 
<span class="menu-text">Assignments</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#ranking-with-gpa" id="toc-ranking-with-gpa" class="nav-link active" data-scroll-target="#ranking-with-gpa">Ranking with GPA</a></li>
  <li><a href="#what-about-the-covariates" id="toc-what-about-the-covariates" class="nav-link" data-scroll-target="#what-about-the-covariates">What about the covariates</a></li>
  <li><a href="#a-political-problem" id="toc-a-political-problem" class="nav-link" data-scroll-target="#a-political-problem">A political problem</a></li>
  <li><a href="#method" id="toc-method" class="nav-link" data-scroll-target="#method">Method</a></li>
  <li><a href="#trying-again" id="toc-trying-again" class="nav-link" data-scroll-target="#trying-again">Trying again</a></li>
  <li><a href="#fill-in-the-matrix-for-each-competition" id="toc-fill-in-the-matrix-for-each-competition" class="nav-link" data-scroll-target="#fill-in-the-matrix-for-each-competition">Fill in the matrix for each competition</a></li>
  <li><a href="#sat-scores-and-academic-performance" id="toc-sat-scores-and-academic-performance" class="nav-link" data-scroll-target="#sat-scores-and-academic-performance">SAT scores and academic performance</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Ranking by grade</h1>
  <div class="quarto-categories">
    <div class="quarto-category">linear algebra</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>DTK </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 8, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Background software
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div>
<div id="webr-1" class="exercise-cell">

</div>
<script type="webr-1-contents">
eyJhdHRyIjp7ImF1dG9ydW4iOnRydWUsImNvbnRleHQiOiJzZXR1cCIsImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiIyBEZWZpbmluZyBmdW5jdGlvbnNcblxuXG5cblxuXG4jIERyYXdpbmcgdmVjdG9ycyBhbmQgbWF0cmljZXNcblxuZHJhd19tYXRyaXggPC0gZnVuY3Rpb24oTSkge1xuICBpbWFnZSgxOm5jb2woTSksIDE6bnJvdyhNKSwgdChNW25yb3coTSk6MSwgXSksXG4gICAgICAgIGNvbCA9IGNvbG9yc3BhY2U6OmRpdmVyZ2luZ19oY2woXG4gICAgICAgICAgMTUsIGggPSBjKDE4MCwgNTApLCBjID0gODAsXG4gICAgICAgICAgbCA9IGMoMjAsIDk1KSwgcG93ZXIgPSBjKDAuNywgMS4zKSksXG4gICAgICAgIGF4ZXMgPSBGQUxTRSxcbiAgICAgICAgdXNlUmFzdGVyID0gVFJVRSlcbn1cblxuc29tZXZlY3MgPC0gdGliYmxlOjp0cmliYmxlKFxuICB+IHJvb3R4LCB+IHJvb3R5LCB+IGhlYWR4LCB+IGhlYWR5LCB+IGNvbG9yLCB+IG5hbWUsXG4gIDAsIDAsIC0yLCA0LCBcImJsdWVcIiwgXCJ1XCIsXG4gIDEsIC0yLCA1LCAtMywgXCJncmVlblwiLCBcInZcIixcbiAgLTEsIC0xLCAtNCwgLTEsIFwib3JhbmdlXCIsIFwid1wiLFxuICAxLCAwLCA0LCAzLCBcImJyb3duXCIsIFwieFwiLFxuICAwLCAtMiwgMywgLTMsIFwic2FsbW9uXCIsIFwieVwiLFxuICAwLCAwLCA0LCAzLCBcIm1hZ2VudGFcIiwgXCJiMVwiLFxuICAwLCAwLCAtMywgMiwgXCJtYWdlbnRhXCIsIFwiYjJcIixcbikgfD5cbiAgZHBseXI6Om11dGF0ZShsYWJlbHggPSAocm9vdHggKyBoZWFkeCkvMixcbiAgICAgICAgIGxhYmVseSA9ICgyKnJvb3R5ICsgaGVhZHkpLzMpXG5zb2x2ZV9mb3IgPC0gZnVuY3Rpb24odmVjbmFtZXMpIHtcbiAgc29tZXZlY3MgfD5cbiAgICBkcGx5cjo6ZmlsdGVyKG5hbWUgJWluJSB2ZWNuYW1lcykgfD5cbiAgICBnZl9zZWdtZW50KHJvb3R5ICsgaGVhZHkgfiByb290eCArIGhlYWR4LFxuICAgICAgICAgICAgICAgYXJyb3cgPSBncmlkOjphcnJvdyhsZW5ndGg9dW5pdCgwLjE1LCBcImluY2hlc1wiKSwgdHlwZT1cImNsb3NlZFwiKSxcbiAgICAgICAgICAgICAgIGNvbG9yID0gfiBjb2xvciwgbGluZXdpZHRoPTIpIHw+XG4gICAgZ2ZfbGFiZWwobGFiZWx5IH4gbGFiZWx4LCBsYWJlbD0gfiBuYW1lLCBjb2xvciA9IH4gY29sb3IsIHNpemU9MykgfD5cbiAgICBnZl9yZWZpbmUoc2NhbGVfY29sb3JfaWRlbnRpdHkoKSxcbiAgICAgICAgICAgICAgc2NhbGVfeV9jb250aW51b3VzKGxpbWl0cz1jKC01LDUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtzPSgtNSk6NSksXG4gICAgICAgICAgICAgIHNjYWxlX3hfY29udGludW91cyhsaW1pdHM9YygtNSw1KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrcz0oLTUpOjUpLFxuICAgICAgICAgICAgICBjb29yZF9maXhlZCgpKSB8PlxuICAgIGdmX2xhYnMoeD1cIlwiLCB5ID0gXCJcIilcbn1cblxuXG5zb2x2ZV9ncmFwaCA8LSBmdW5jdGlvbihzZWVkPTEwMSwgaW50ZWdlcnM9RkFMU0UpIHtcbiAgc2V0LnNlZWQoc2VlZClcbiAgaWYgKGludGVnZXJzKSB7XG4gICAgdSA8LSB2ZWMoc2FtcGxlKHNldGRpZmYoLTU6NSwgMCksIHNpemUgPSAyKSlcbiAgICB2IDwtIHZlYyhzYW1wbGUoc2V0ZGlmZigtNTo1LCAwKSwgc2l6ZSA9IDIpKVxuICAgICMgaWYgdG9vIGNsb3NlIGluIGFuZ2xlLCB0cnkgYWdhaW5cbiAgICB3aGlsZSAoIGFicygodSAlZG90JSB2KSAvICh2ZWNsZW4odSkqdmVjbGVuKHYpKSkgPiAwLjYgKVxuICAgICAgdiA8LSB2ZWMoc2FtcGxlKC01OjUsIHNpemU9MikpXG4gIH0gZWxzZSB7XG4gICAgdSA8LSB2ZWMoc2FtcGxlKGMoLTU6NSwgcnVuaWYoMywgLTMsIDMpKSwgc2l6ZSA9IDIpKVxuICAgIHYgPC0gdmVjKHNhbXBsZShjKC01OjUsIHJ1bmlmKDMsIC0zLCAzKSksIHNpemUgPSAyKSlcbiAgICAjIGlmIHRvbyBjbG9zZSBpbiBhbmdsZSwgdHJ5IGFnYWluXG4gICAgd2hpbGUgKCBhYnMoKHUgJWRvdCUgdikgLyAodmVjbGVuKHUpKnZlY2xlbih2KSkpID4gMC42IClcbiAgICAgIHYgPC0gdmVjKHNhbXBsZShjKC0zOjMsIHJ1bmlmKDMsIC0zLCAzKSksIHNpemU9MikpXG4gIH1cbiAgdWNvZWYgPC0gc2FtcGxlKHNldGRpZmYoLTI6MiwgMCksIHNpemUgPSAxKVxuICB2Y29lZiA8LSBzYW1wbGUoc2V0ZGlmZigtMjoyLCAwKSwgc2l6ZSA9IDEpXG4gIGIgPC0gdSp1Y29lZiArIHYqdmNvZWZcbiAgYm90aCA8LSBtYXRyaXgoIGMoMCwgMCwgdSwgMCwgMCwgdiwgMCwgMCwgYiksXG4gICAgICAgICAgICAgICAgICBuY29sPTQsIGJ5cm93ID0gVFJVRSkgfD5cbiAgICB0aWJibGU6OmFzX3RpYmJsZSgpXG4gIG5hbWVzKGJvdGgpIDwtIGMoXCJyb290eFwiLCBcInJvb3R5XCIsIFwiaGVhZHhcIiwgXCJoZWFkeVwiKVxuICBib3RoJGxhYmVsIDwtIGMoXCJhXCIsIFwiY1wiLCBcImJcIilcbiAgYm90aCRjb2xvciA8LSBjKHNhbXBsZShjKFwiYmx1ZVwiLCBcImRhcmtvcmFuZ2VcIiwgXCJ0b21hdG9cIiwgXCJicm93blwiLFwibWFnZW50YVwiLCBcInJlZFwiKSwgc2l6ZT0yKSxcbiAgICAgICAgICAgICAgICAgIFwiZm9yZXN0Z3JlZW5cIilcbiAgYm90aCA8LSBib3RoIHw+XG4gICAgZHBseXI6Om11dGF0ZShsYWJlbHggPSAocm9vdHggKyBoZWFkeCkvMixcbiAgICAgICAgICAgICAgICAgIGxhYmVseSA9ICgyKnJvb3R5ICsgaGVhZHkpLzMpXG5cbiAgbG9uZ2VzdCA8LSByb3VuZChtYXgoYWJzKGModSwgdiwgYikpKSArIDEpXG4gIHNraXAgPC0gaWZlbHNlKGxvbmdlc3QgPiA3LCAyLCAxKVxuXG4gIGJvdGggfD5cbiAgICAjIGRwbHlyOjpmaWx0ZXIobGFiZWwgIT0gXCJiXCIpIHw+XG4gICAgZ2Zfc2VnbWVudChyb290eSArIGhlYWR5IH4gcm9vdHggKyBoZWFkeCxcbiAgICAgICAgICAgICAgIGFycm93ID0gZ3JpZDo6YXJyb3cobGVuZ3RoPXVuaXQoMC4xNSwgXCJpbmNoZXNcIiksIHR5cGU9XCJjbG9zZWRcIiksXG4gICAgICAgICAgICAgICBjb2xvciA9IH4gY29sb3IsIGxpbmV3aWR0aD0yKSB8PlxuICAgIGdmX2xhYmVsKGxhYmVseSB+IGxhYmVseCwgbGFiZWw9IH4gbGFiZWwsIGNvbG9yID0gfiBjb2xvciwgc2l6ZT0zKSB8PlxuICAgIGdmX3JlZmluZShzY2FsZV9jb2xvcl9pZGVudGl0eSgpLFxuICAgICAgICAgICAgICBzY2FsZV95X2NvbnRpbnVvdXMobGltaXRzPWMoLWxvbmdlc3QsIGxvbmdlc3QpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtzPXNlcSgtbG9uZ2VzdCwgbG9uZ2VzdCwgYnkgPSBza2lwKSksXG4gICAgICAgICAgICAgIHNjYWxlX3hfY29udGludW91cyhsaW1pdHM9YygtbG9uZ2VzdCwgbG9uZ2VzdCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVha3M9c2VxKC1sb25nZXN0LCBsb25nZXN0LCBieSA9IHNraXApKSxcbiAgICAgICAgICAgICAgY29vcmRfZml4ZWQoKSkgfD5cbiAgICAjIGdmX2xhYmVsKGhlYWR5IH4gaGVhZHgsXG4gICAgIyAgICAgICAgICBsYWJlbCA9IH4gbGFiZWwsXG4gICAgIyAgICAgICAgICBjb2xvciA9IH4gY29sb3IsXG4gICAgIyAgICAgICAgICBkYXRhID0gYm90aCB8PiBkcGx5cjo6ZmlsdGVyKGxhYmVsID09IFwiYlwiKSkgfD5cbiAgICBnZl9sYWJzKHg9XCJcIiwgeSA9IFwiXCIpIHw+XG4gICAgZ2ZfcmVmaW5lKHRoZW1lX21pbmltYWwoKSlcbn1cblxuXG5cbiMgU2ltcGxlIHZlY3Rvci9tYXRyaXggb3BlcmF0aW9uc1xuXG52ZWMgPC0gZnVuY3Rpb24oLi4uKSB7XG4gIHZhbHMgPC0gbGlzdCguLi4pIHw+IHVubGlzdCgpXG4gIG1hdHJpeCh2YWxzLCBuY29sPTEpXG59XG5cbnJ2ZWMgPC0gZnVuY3Rpb24oZmlyc3QsIC4uLiwgcmZ1bj1ybm9ybSkge1xuICBkb3RzIDwtIGMoZmlyc3QsIGxpc3QoLi4uKSkgfD4gdW5saXN0KClcbiAgaWYgKGxlbmd0aChkb3RzKSA9PSAxKSB7XG4gICAgZG90cyA8LSByZnVuKGRvdHNbWzFdXSlcbiAgfVxuXG4gIHZlYyhkb3RzKVxufVxuXG4jIENvbnZlbmllbmNlIGZ1bmN0aW9ucyBvbiB2ZWN0b3JzIGFuZCBtYXRyaWNlc1xuXG4jIEdpdmUgYSBjb2xuYW1lIHRvIGEgdmVjdG9yIG9yIG11bHRpcGxlIGNvbG5hbWVzIHRvIGEgbWF0cml4XG52ZWNfbmFtZXMgPC0gYGNvbG5hbWVzPC1gXG4jIFZlY3RvciBtaW51cyB0aGUgbWVhblxudmVjX21tIDwtIGZ1bmN0aW9uKC4uLikgIHtcbiAgdiA8LSB2ZWMoLi4uKVxuICB2IC0gbWVhbih2LCBuYS5ybSA9IFRSVUUpXG59XG5cbiMgYXJiaXRyYXJ5IHZlYy0+dmVjIG9yIHZlYy0+c2NhbGFyIGZ1bmN0aW9uIGFwcGxpZWQgdG8gZWFjaCBjb2x1bW4gb2YgYSB2ZWN0b3Jcbk1fbWFwIDwtIGZ1bmN0aW9uKE0sIGYgPSBcImNlbnRlclwiKSB7XG4gIGNob2ljZXMgPC0gYyhcImNlbnRlclwiLCBcInVuaXRcIixcbiAgICAgICAgICAgICAgIFwidW5pdGNlbnRlclwiLCBcIm1lYW5cIiwgXCJ2YXJcIiwgXCJ2bGVuXCIpXG5cbiAgc3RyIDwtIGFzLmNoYXJhY3RlcihzdWJzdGl0dXRlKGYpKVxuICBpZiAoc3RyWzFdICVpbiUgY2hvaWNlcykge1xuICAgIGYgPC0gc3dpdGNoIChzdHJbMV0sXG4gICAgICAgICAgICAgICAgIGNlbnRlciA9IFxcKHgpICh4IC0gbWVhbih4LCBuYS5ybSA9IFRSVUUpKSxcbiAgICAgICAgICAgICAgICAgdW5pdCA9IFxcKHgpIHggLyBzcXJ0KHN1bSh4XjIpKSxcbiAgICAgICAgICAgICAgICAgbWVhbiA9IFxcKHgpIG1lYW4oeCwgbmEucm0gPSBUUlVFKSxcbiAgICAgICAgICAgICAgICAgdmFyID0gXFwoeCkgdmFyKHgsIG5hLnJtID0gVFJVRSksXG4gICAgICAgICAgICAgICAgIGxlbiA9IFxcKHgpIHNxcnQoc3VtKHgqeCkpLFxuICAgICAgICAgICAgICAgICBsZW4yID0gXFwoeCkgc3VtKHgqeCksXG4gICAgICAgICAgICAgICAgIHVuaXRjZW50ZXIgPSBmdW5jdGlvbih4KSB7XG4gICAgICAgICAgICAgICAgICAgdiA8LSB4IC0gbWVhbih4LCBuYS5ybSA9IFRSVUUpXG4gICAgICAgICAgICAgICAgICAgdiAvIHNxcnQoc3VtKHZeMikpXG4gICAgICAgICAgICAgICAgIH1cbiAgICApXG4gIH1cbiAgaWYgKCFpcy5mdW5jdGlvbihmKSkgc3RvcChcIk5vdCBhIHJlY29nbml6ZWQgZnVuY3Rpb24uXCIpXG4gIGZpcnN0IDwtIGYoTVssMV0pXG4gIHJlcyA8LSBtYXRyaXgoMCwgbGVuZ3RoKGZpcnN0KSwgbmNvbChNKSlcbiAgZm9yIChrIGluIDE6bmNvbChNKSkge1xuICAgIHJlc1ssIGtdIDwtIGYoTVssa10pXG4gIH1cbiAgcmVzXG59XG5cblxuXG5zZXRfY29sX25hbWVzIDwtIGZ1bmN0aW9uKHYsIG5tcykge1xuICBjb2xuYW1lcyh2KSA8LSBubXNcbiAgdlxufVxub25lX3NpZGVkIDwtIGZ1bmN0aW9uKHRpbGRlKSB7XG4gaWYgKGxlbmd0aCh0aWxkZSkgPT0gMylcbiAgIHN0b3AoXCJUaGUgdGlsZGUgZXhwcmVzc2lvbiBzaG91bGQgYmUgb25lLXNpZGVkLCBlLmcuIH4gYiwgbm90IGEgfiBiXCIpXG59XG4jIGNyZWF0ZSBhIG1vZGVsIG1hdHJpeCBwaXBlIHN0eWxlXG5kYXRhX00gPC0gZnVuY3Rpb24oLmRhdGEsIHRpbGRlKSB7XG4gIE0gPC0gbW9kZWwubWF0cml4KHRpbGRlLCBkYXRhID0gLmRhdGEgfD4gdGliYmxlOjpyZW1vdmVfcm93bmFtZXMoKSlcbiAgTVsgLCAtIHdoaWNoKGNvbG5hbWVzKE0pID09IFwiKEludGVyY2VwdClcIiksIGRyb3AgPSBGQUxTRV1cbn1cblxudmVjbGVuIDwtIGZ1bmN0aW9uKHYpIHNxcnQodiAlZG90JSB2KVxudW5pdHZlYyA8LSBmdW5jdGlvbih2ZWMpIHZlYy9sZW5ndGgodmVjKVxuY2FuZyA8LSBmdW5jdGlvbih2LCB3KSB7KHYgJWRvdCUgdykgLyAodmVjbGVuKHYpICogdmVjbGVuKHcpKX1cbm1ha2VRIDwtIGZ1bmN0aW9uKC4uLikge1xuICBkb3RzIDwtIGxpc3QoLi4uKSB8PiBiaW5kX2NvbHMoKVxuICBxci5RKHFyKGRvdHMpKVxufVxuXG5jaGVja19mb3Jfc3ZkIDwtIGZ1bmN0aW9uKFMpIHtcbiAgaWYgKGluaGVyaXRzKFMsIFwibWF0cml4XCIpKSBTIDwtIHN2ZChTKVxuICBpZiAoIWlzLmxpc3QoUykgfHwgIWFsbChjKFwiZFwiLFwidlwiLCBcInVcIikgJWluJSBuYW1lcyhTKSkpXG4gICAgc3RvcChcIkFyZ3VtZW50IG11c3QgYmUgbWF0cml4IG9yIHRoZSBTVkQgb2YgYSBtYXRyaXguXCIpXG4gIFNcbn1cblxucmFua19tYXQgPC0gZnVuY3Rpb24oUywgdGhyZXNoID0gMC4wMSkge1xuICBTIDwtIGNoZWNrX2Zvcl9zdmQoUylcbiAgc3VtKFMkZCA+IFMkZFsxXSAqIHRocmVzaClcbn1cblxucmFuZF9tYXQgPC0gZnVuY3Rpb24obnJvdz0zLCBuY29sPTYsIHJhbmsgPSBwbWluKG5yb3csIG5jb2wpKSB7XG4gIE0gPC0gbWF0cml4KHJ1bmlmKG5yb3cqbmNvbCksIG5yb3cgPSBucm93LCBuY29sID0gbmNvbClcbiAgaWYgKHJhbmsgPj0gbnJvdyB8fCByYW5rID49IG5jb2wpIHtcbiAgIE1cbiAgfSBlbHNlIHtcbiAgICBhcHByb3hfbWF0KFMsIG49c2FtcGxlKHBtaW4ocmFuaywgbnJvdywgbmNvbCkpKVxuICB9XG59XG5cbiMgR3JhYiByYW5rIDEgbWF0cml4IGZyb20gU1ZEXG5hcHByb3hfbWF0IDwtIGZ1bmN0aW9uKFMsIG49MSwgb3JkZXIgPSAwKSB7ICMgaW5wdXQgYSBtYXRyaXggb3IgdGhlIFNWRCBvZiBhIG1hdHJpeFxuICBTIDwtIGNoZWNrX2Zvcl9zdmQoUylcbiAgaWYgKG9yZGVyID4gMCkge1xuICAgIGluZHMxIDwtIG9yZGVyKGMoUyR1WyxvcmRlcl0pKVxuICAgIGluZHMyIDwtIG9yZGVyKGMoUyR2WyxvcmRlcl0pKVxuICB9IGVsc2Uge1xuICAgIGluZHMxIDwtIDE6bnJvdyhTJHUpXG4gICAgaW5kczIgPC0gMTpucm93KFMkdilcbiAgfVxuICBwYXJ0aWFsIDwtIDAgIyBpbml0aWFsIHZhbHVlXG4gIGZvciAoayBpbiBuKSB7XG4gICAgcGFydGlhbCA8LSBwYXJ0aWFsICsgIFMkZFtrXSAqIFMkdVtpbmRzMSxrLCBkcm9wID0gRkFMU0VdICUqJSB0KFMkdltpbmRzMixrLCBkcm9wID0gRkFMU0VdKVxuICB9XG5cbiAgcGFydGlhbFxufVxuXG5wcmV0dHlfbWF0IDwtIGZ1bmN0aW9uKE0pIHtcbiAgaW5kczEgPC0gb3JkZXIocm93U3VtcyhNKSlcbiAgaW5kczIgPC0gb3JkZXIoY29sU3VtcyhNKSlcbiAgTVtpbmRzMSwgaW5kczJdXG59XG5cbiMnIEdlbmVyYXRlIGEgbWF0cml4IHdob3NlIGVsZW1lbnRzIGFyZSBzZWxlY3RlZCByYW5kb21seSBmcm9tIGEgc2V0XG4jJyBvZiBzcGVjaWZpZWQgdmFsdWVzLlxuIycgQHBhcmFtIG5yb3cgbnVtYmVyIG9mIHJvd3MgZm9yIHRoZSBtYXRyaXggcHJvZHVjZWRcbiMnIEBwYXJhbSBuY29sIG51bWJlciBvZiBjb2x1bW5zXG4jJyBAcGFyYW0gdmFsdWVzIHRoZSBzZXQgZnJvbSB3aGljaCB0byBkcmF3IChyYW5kb21seSkgdGhlXG4jJyB2YWx1ZXMgaW4gdGhlIG1hdHJpeC4gRGVmYXVsdDogaW50ZWdlcnMgLTkgdG8gOVxudmFsdWVzX21hdCA8LSBmdW5jdGlvbihucm93PTQsIG5jb2w9MywgdmFsdWVzID0gLTk6OSkge1xuICBtYXRyaXgoc2FtcGxlKHZhbHVlcywgc2l6ZSA9IG5yb3cgKiBuY29sLCByZXBsYWNlID0gVFJVRSksXG4gICAgICAgICBucm93ID0gbnJvdywgbmNvbD1uY29sKVxufVxuXG4jIFR5cGVzZXQgbWF0cmljZXMgaW4gTGFUZVggKGZvciBhc3NpZ25tZW50cyBhbmQgc3VjaClcbkxtYXQgPC0gZnVuY3Rpb24obnIsIG5jKSB7XG4gIHZhbHVlc19tYXQobnIsIG5jKSB8PiBsYXRleF9oZWxwZXIoKVxufVxubGF0ZXhfaGVscGVyIDwtIGZ1bmN0aW9uKG1hdHIpIHtcbiAgcHJpbnRtcm93IDwtIGZ1bmN0aW9uKHgpIHtcblxuICAgIGNhdChjYXQoeCxzZXA9XCIgJiBcIiksXCJcXFxcXFxcXCBcXG5cIilcbiAgfVxuXG4gIGNhdChcIlxcXFxsZWZ0KFxcXFxiZWdpbnthcnJheX17cn1cIixcIlxcblwiKVxuICBib2R5IDwtIGFwcGx5KG1hdHIsMSxwcmludG1yb3cpXG4gIGNhdChcIlxcXFxlbmR7YXJyYXl9XFxcXHJpZ2h0KVwiKVxufVxuXG4jIEZvdXJpZXIgdHJhbnNmb3JtIHN0dWZmXG4jIHNpZ2ZmdCBzaG93cyBvbmx5IHRoZSBsZWZ0LWhhbmQgc2lkZSBvZiB0aGUgRkZUXG4jIGlzaWdmZnQgcmVzdG9yZXMgaXQgYnkgYWRkaW5nIGJhY2sgdGhlIHJpZ2h0LWhhbmQgc2lkZSB0aGVuIGludmVyc2UgRkZULlxuXG5pZmZ0IDwtIGZ1bmN0aW9uKHgpIGZmdCh4L2xlbmd0aCh4KSwgaW52ZXJzZSA9IFRSVUUpXG5cbnNpZ2ZmdCA8LSBmdW5jdGlvbih4KSB7XG4gIHRtcCA8LSBmZnQoeClcbiAgbnlxdWlzdCA8LSByb3VuZCgobGVuZ3RoKHgpICsgMS4xIC0gKGxlbmd0aCh4KSAlJSAyKSkvMilcbiAgdG1wWzE6bnlxdWlzdF1cbn1cbmlzaWdmZnQgPC0gZnVuY3Rpb24oTGZmdHgpIHtcbiAgdG1wIDwtIGlmIChsZW5ndGgoTGZmdHgpICUlIDIpIHtcbiAgICAjIG9kZCBsZW5ndGhcbiAgICBjKExmZnR4LCBDb25qKHJldihMZmZ0eFtjKC0xLCAtbGVuZ3RoKExmZnR4KSldKSkpXG5cbiAgfSBlbHNlIHtcbiAgICBjKExmZnR4LCBDb25qKHJldihMZmZ0eFstMV0pKSlcbiAgfVxuICBpZmZ0KHRtcCkgfD4gUmUoKVxufVxuXG5zcXVhc2hfc21hbGwgPC0gZnVuY3Rpb24oeCwgdG9sPTFlLTkpIHtcbiAgcjEgPC0gUmUoeClcbiAgcjEgPC0gaWZlbHNlKGFicyhyMSkgPCB0b2wsIDAsIHIxKVxuICBjMSA8LSBJbSh4KVxuICBjMSA8LSBpZmVsc2UoYWJzKGMxKSA8IHRvbCwgMCwgYzEpXG4gICMgcmV0dXJuIHJlYWwgcGFydCBpZiBhbGwgb2YgaW1hZ2luYXJ5IHBhcnQgaXMgc21hbGxcbiAgaWYgKGFsbChjMSA9PSAwKSkgcjFcbiAgZWxzZSByMSArIDFpICogYzFcbn1cblxuIyBQbG90IHRoZSBhbXBsaXR1ZGUgc3BlY3RydW0gdmVyc3VzIGZyZXF1ZW5jeVxuc2lnX2FtcF9zcGVjIDwtIGZ1bmN0aW9uKHgsIHNhbXBmcmVxPTEwMCkge1xuICBUbXAgPC0gdGliYmxlOjp0aWJibGUoXG4gICAgYW1wID0gYWJzKHNpZ2ZmdCh4KSksXG4gICAgZnJlcXVlbmN5ID0gc2VxKDAsIHNhbXBmcmVxLzIsIGxlbmd0aCA9IGxlbmd0aChhbXApKSlcbiAgVG1wIHw+XG4gICAgZ2Zfc2VnbWVudCgwICsgYW1wIH4gZnJlcXVlbmN5ICsgZnJlcXVlbmN5LCBhbHBoYSA9IDAuMikgfD5cbiAgICBnZl9wb2ludChhbXAgfiBmcmVxdWVuY3ksIGNvbG9yID0gXCJibHVlXCIsIHNpemUgPSAwLjUpXG59XG5cblxuXG4jIFBsb3R0aW5nIGEgZnVuY3Rpb24gd2l0aCByb29tIGZvciBkcmF3aW5nIHRoZSBhbnRpLWRlcml2XG5kcmF3RnBhaXIgPC0gZnVuY3Rpb24oZiwgZG9tID0gZG9tYWluKHggPSAwOjQpLCBib3R0b20gPSAtMC41LCBhbHBoYT0wKSB7XG4gICMgYWxwaGEgPSAwIGZvciBwcm9ibGVtXG4gICMgYWxwaGEgPSAxIGZvciBhbnN3ZXJcbiAgZm5hbWUgPC0gYXMuY2hhcmFjdGVyKHN1YnN0aXR1dGUoZikpXG4gIHZuYW1lIDwtIG5hbWVzKGRvbSlcbiAgdGlsZGUgPC0gZ2x1ZTo6Z2x1ZShcIntmbmFtZX0oe3ZuYW1lfSkgfiB7dm5hbWV9XCIpXG4gIGxhYmVsIDwtIGdsdWU6OmdsdWUoXCJ7Zm5hbWV9KHt2bmFtZX0pXCIpXG4gIEZ0aWxkZSA8LSBnbHVlOjpnbHVlKFwie3RvdXBwZXIoZm5hbWUpfSh7dm5hbWV9KSB+IHt2bmFtZX1cIilcbiAgbGFiZWxGIDwtIGdsdWU6OmdsdWUoXCJ7dG91cHBlcihmbmFtZSl9KHt2bmFtZX0pXCIpXG4gIFAxIDwtIHNsaWNlX3Bsb3QoYXMuZm9ybXVsYSh0aWxkZSksIGRvbSwgbnB0cyA9IDEwMDApIHw+XG4gICAgZ2ZfbGFicyh5ID0gbGFiZWwsIHggPSBcIlwiKSB8PlxuICAgIGdmX2xpbXMoeSA9IGMoYm90dG9tLCBOQSkpIHw+XG4gICAgZ2ZfaGxpbmUoeWludGVyY2VwdCA9IDAsIGNvbG9yID0gXCJibHVlXCIsIGxpbmV0eXBlID0gXCJkYXNoZWRcIikgfD5cbiAgICBnZl90aGVtZSh0aGVtZV9taW5pbWFsKGJhc2Vfc2l6ZSA9IDIyKSlcbiAgYXNzaWduKHRvdXBwZXIoZm5hbWUpLCBhbnRpRChhcy5mb3JtdWxhKHRpbGRlKSkpXG4gIFAyIDwtIHNsaWNlX3Bsb3QoYXMuZm9ybXVsYShGdGlsZGUpLCBkb20sIGFscGhhID0gYWxwaGEpIHw+XG4gICAgZ2ZfbGFicyh5ID0gbGFiZWxGLCB4ID0gdm5hbWUpIHw+XG4gICAgZ2ZfaGxpbmUoeWludGVyY2VwdCA9IDAsIGNvbG9yID0gXCJibHVlXCIsIGxpbmV0eXBlID0gXCJkYXNoZWRcIikgfD5cbiAgICBnZl90aGVtZSh0aGVtZV9taW5pbWFsKGJhc2Vfc2l6ZSA9IDIyKSlcbiAgbGlzdChQMSA9IFAxLCBQMiA9IFAyKVxufVxuXG4jIERyYXcgUmllbWFubiBib3hlcyBvbiBhIGZ1bmN0aW9uOlxuXG5ycGxvdCA8LSBmdW5jdGlvbih0aWxkZSwgZG9tYWluLCBucHRzID0gMTEsIHBvc2l0aW9uPWMoXCJsZWZ0XCIsIFwibWlkZGxlXCIsIFwicmlnaHRcIiksIC4uLikge1xuICBwb3NpdGlvbiA9IG1hdGNoLmFyZyhwb3NpdGlvbilcbiAgZiA8LSBtYWtlRnVuKHRpbGRlLCAuLi4pXG4gIGVuZHMgPC0gZG9tYWluW1sxXV1cbiAgaCA8LSBkaWZmKGVuZHMpLyhucHRzIC0gMSlcbiAgcG9pbnRzIDwtIHNlcShlbmRzWzFdLCBlbmRzWzJdLCBieSA9IGgpXG4gIFB0cyA8LSB0aWJibGU6OnRpYmJsZShcbiAgICBsZWZ0ID0gcG9pbnRzWy1sZW5ndGgocG9pbnRzKV0sXG4gICAgcmlnaHQgPSBwb2ludHNbLTFdLFxuICAgIG1pZCA9IChsZWZ0ICsgcmlnaHQpLzJcbiAgKVxuICBQdHMkdmFsIDwtIGlmIChwb3NpdGlvbiA9PSBcImxlZnRcIikgZihQdHMkbGVmdClcbiAgZWxzZSBpZiAocG9zaXRpb24gPT0gXCJtaWRkbGVcIikgZihQdHMkbWlkKVxuICBlbHNlIGlmIChwb3NpdGlvbiA9PSBcInJpZ2h0XCIpIGYoUHRzJHJpZ2h0KVxuICBlbHNlIHN0b3AoXCJJbnZhbGlkIDxwb3NpdGlvbj4gYXJndW1lbnQuXCIpXG5cbiAgUHRzJGNvbG9yIDwtIGlmZWxzZShQdHMkdmFsID4gMCwgXCJibHVlXCIsIFwidG9tYXRvXCIpXG4gIHNsaWNlX3Bsb3QodGlsZGUsIGRvbWFpbiwgbnB0cz01MDEpIHw+XG4gICAgZ2ZfaGxpbmUoeWludGVyY2VwdCA9IH4gMCwgY29sb3IgPSBcImJsdWVcIikgfD5cbiAgICBnZl9yZWN0KDAgKyB2YWwgfiBsZWZ0ICsgcmlnaHQsIGRhdGEgPSBQdHMsXG4gICAgICAgICAgICBpbmhlcml0ID0gRkFMU0UsIGZpbGwgPSBOQSwgYWxwaGEgPSAwLFxuICAgICAgICAgICAgY29sb3IgPSBcImJsYWNrXCIsIGxpbmV3aWR0aCA9IDAuMSkgfD5cbiAgICBnZl9yZWN0KDAgKyB2YWwgfiAgbGVmdCArIHJpZ2h0LCBkYXRhID0gUHRzLFxuICAgICAgICAgICAgZmlsbCA9IH4gY29sb3IsXG4gICAgICAgICAgICBpbmhlcml0ID0gRkFMU0UsIGFscGhhID0gMC4yKSB8PlxuICAgIGdmX3JlZmluZShzY2FsZV9maWxsX2lkZW50aXR5KCkpIHw+XG4gICAgZ2ZfdGhlbWUodGhlbWVfdm9pZClcblxufVxuXG5cbmlmICghZXhpc3RzKFwidGFrZV9zYW1wbGVcIikpIHtcbiAgdGFrZV9zYW1wbGUgPDwtIGZ1bmN0aW9uICh4LCBuLCByZXBsYWNlID0gRkFMU0UsIC4uLikge1xuICAgIFVzZU1ldGhvZCgndGFrZV9zYW1wbGUnKVxuICB9XG5cblxuICAjJyBAZXhwb3J0XG4gIHRha2Vfc2FtcGxlLnZlY3RvciA8PC0gZnVuY3Rpb24oeCwgbj1sZW5ndGgoeCksIHJlcGxhY2U9RkFMU0UsIC4uLikge1xuICAgIGJhc2U6OnNhbXBsZSh4LCBzaXplID0gbiwgcmVwbGFjZSA9IHJlcGxhY2UsIC4uLilcbiAgfVxuXG4gICMnIEBleHBvcnRcbiAgdGFrZV9zYW1wbGUuZGF0YS5mcmFtZSA8PC0gZnVuY3Rpb24oeCwgbiA9IG5yb3coeCksIHJlcGxhY2UgPSBGQUxTRSwgLi4uLCAuYnkgPSBOVUxMKSB7XG5cbiAgICAjIHNsaWNlX3NhbXBsZSB1c2VzIGBieWAgaW5zdGVhZCBvZiBgLmJ5YFxuICAgICMgSSBjYW4gZ2V0IHRoaXMgdG8gd29yayBvbmx5IGJ5IHR1cm5pbmcgYC5ieWAgaW50byBhIGNoYXJhY3RlciBzdHJpbmdcbiAgICAjIGNvbnRhaW5pbmcgdGhlIGRlc2lyZWQgbmFtZXMuXG4gICAgZ3JvdXBzIDwtIHN1YnN0aXR1dGUoLmJ5KSAjIGBncm91cHNgIHdpbGwgYmUgYSBjYWxsXG5cbiAgICBpZiAoIWlzLm51bGwoZ3JvdXBzKSkge1xuICAgICAgIyBoYW5kbGUgY2FzZXMgd2l0aCBtdWx0aXBsZSAuYnkgdmFyaWFibGVzXG4gICAgICBpZiAoaXMuY2FsbChncm91cHMpKSB7XG4gICAgICAgIGlmICghaXMubmFtZShncm91cHNbWzJdXSkpIGdyb3VwcyA8LSBldmFsKGdyb3VwcylcbiAgICAgICAgZWxzZSBncm91cHMgPC0gYWxsLnZhcnMoZ3JvdXBzKVxuICAgICAgfVxuICAgIH1cblxuICAgIGRwbHlyOjpzbGljZV9zYW1wbGUoeCwgbiA9IG4sIGJ5ID0gYWxsX29mKGdyb3VwcyksIHJlcGxhY2UgPSByZXBsYWNlKVxuICB9XG5cbiAgIycgQGV4cG9ydFxuICB0YWtlX3NhbXBsZS5kYXRhc2ltIDw8LSBmdW5jdGlvbih4LCBuID0gNSwgcmVwbGFjZSA9IEZBTFNFLCAuLi4sIHNlZWQgPSBOVUxMLCByZXBvcnRfaGlkZGVuPUZBTFNFKSB7XG4gICAgZGF0YXNpbV9ydW4oeCwgbiA9IG4sIHNlZWQgPSBzZWVkLCByZXBvcnRfaGlkZGVuID0gcmVwb3J0X2hpZGRlbilcbiAgfVxuXG4gICMnIEBwYXJhbSAuYnkgVmFyaWFibGVzIHRvIHVzZSB0byBkZWZpbmUgZ3JvdXBzIGZvciBzYW1wbGluZywgYXMgaW4gYHtkcGx5cn1gLiBUaGUgc2FtcGxlIHNpemVcbiAgIycgYXBwbGllcyB0byBlYWNoIGdyb3VwLlxuICAjJyBAcGFyYW0gZ3JvdXBzIFZhcmlhYmxlIGluZGljYXRpbmcgYmxvY2tzIHRvIHNhbXBsZSB3aXRoaW5cbiAgIycgQHBhcmFtIG9yaWcuaWRzIExvZ2ljYWwuIElmIGBUUlVFYCwgYXBwZW5kIGEgY29sdW1uIG5hbWVkIFwib3JpZy5pZHNcIiB3aXRoIHRoZVxuICAjJyByb3cgZnJvbSB0aGUgb3JpZ2luYWwgYHhgIHRoYXQgdGhlIHNhbWUgY2FtZSBmcm9tLlxuICAjJyBAcGFyYW0gcHJvYiBQcm9iYWJpbGl0aWVzIHRvIHVzZSBmb3Igc2FtcGxpbmcsIG9uZSBmb3IgZWFjaCBlbGVtZW50IG9mIGB4YFxuICAjJ1xuICAjJyBAcmRuYW1lIHRha2Vfc2FtcGxlXG4gICMnIEBleHBvcnRcbiAgdGFrZV9zYW1wbGUuZGVmYXVsdCA8PC0gZnVuY3Rpb24oeCwgbiA9IGxlbmd0aCh4KSwgcmVwbGFjZT1GQUxTRSwgcHJvYj1OVUxMLCAuYnkgPSBOVUxMLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwcyA9IC5ieSwgb3JpZy5pZHM9RkFMU0UsIC4uLikge1xuICAgIHNpemUgPC0gblxuICAgIG1pc3NpbmdTaXplIDwtIG1pc3Npbmcoc2l6ZSlcbiAgICBoYXZlR3JvdXBzIDwtICEgaXMubnVsbChncm91cHMpXG4gICAgaWYgKGxlbmd0aCh4KSA9PSAxTCAmJiBpcy5udW1lcmljKHgpICYmIHggPj0gMSkge1xuICAgICAgbiA8LSB4XG4gICAgICB4IDwtIDE6blxuICAgICAgaWYgKG1pc3NpbmdTaXplKSAgc2l6ZSA8LSBuXG4gICAgfSBlbHNlIHtcbiAgICAgIG4gPC0gbGVuZ3RoKHgpXG4gICAgICBpZiAobWlzc2luZ1NpemUpIHNpemUgPC0gbGVuZ3RoKHgpXG4gICAgfVxuICAgIGlmIChoYXZlR3JvdXBzICYmIHNpemUgIT0gbikge1xuICAgICAgd2FybmluZyhcIidzaXplJyBpcyBpZ25vcmVkIHdoZW4gdXNpbmcgZ3JvdXBzLlwiKVxuICAgICAgc2l6ZSA8LSBuXG4gICAgfVxuICAgIGlkcyA8LSAxOm5cblxuICAgIGlmIChoYXZlR3JvdXBzKSB7XG4gICAgICBncm91cHMgPC0gcmVwKCBncm91cHMsIGxlbmd0aC5vdXQgPSBzaXplKSAgIyByZWN5Y2xlIGFzIG5lZWRlZFxuICAgICAgcmVzdWx0IDwtIHN0YXRzOjphZ2dyZWdhdGUoIGlkcywgYnkgPSBsaXN0KGdyb3VwcyksIEZVTiA9IGJhc2U6OnNhbXBsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaW1wbGlmeSA9IEZBTFNFLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2UgPSByZXBsYWNlLCBwcm9iID0gcHJvYilcbiAgICAgIHJlc3VsdCA8LSB1bmxpc3QocmVzdWx0JHgpXG4gICAgICBpZiAob3JpZy5pZHMpIHsgbm1zIDwtIGlkc1tyZXN1bHRdIH1cbiAgICAgIHJlc3VsdCA8LSB4W3Jlc3VsdF1cbiAgICAgIGlmIChvcmlnLmlkcykgeyBuYW1lcyhyZXN1bHQpIDwtIG5tcyB9XG4gICAgICByZXR1cm4ocmVzdWx0KVxuICAgIH1cbiAgICByZXN1bHQgPC0gYmFzZTo6c2FtcGxlKHgsIHNpemUsIHJlcGxhY2UgPSByZXBsYWNlLCBwcm9iID0gcHJvYilcbiAgICByZXR1cm4ocmVzdWx0KVxuICB9XG5cbn1cblxuaWYgKCFleGlzdHMoXCJyZXNhbXBsZVwiKSkge1xuICByZXNhbXBsZSA8PC0gZnVuY3Rpb24oLi4uLCByZXBsYWNlID0gVFJVRSkge1xuICAgIHRha2Vfc2FtcGxlKC4uLiwgcmVwbGFjZSA9IHJlcGxhY2UpXG4gIH1cbn1cblxuICAjJyBBIGNvbnZlbmllbmNlIGZ1bmN0aW9uIGZvciBzaHVmZmxpbmcsIHR5cGljYWxseSB1c2VkIHdpdGhcbiAgIycgd2l0aGluIG1vZGVsX3RyYWluKCksIGJ1dCBhdmFpbGFibGUgZWxzZXdoZXJlIGZvciwgZS5nLiBkZW1vbnN0cmF0aW9uc1xuICAjJyBAcmRuYW1lIHRha2Vfc2FtcGxlXG4gICMnIEBleHBvcnRcbmlmICghZXhpc3RzKFwic2h1ZmZsZVwiKSkge1xuICBzaHVmZmxlIDw8LSBmdW5jdGlvbiguLi4pIHtcbiAgICB0YWtlX3NhbXBsZSguLi4pXG4gIH1cbn1cblxuXG5cbiMjIERyYXcgYSBmbG93IGZpZWxkIGFuZCBudWxsY2xpbmVzXG5kcmF3X2Zsb3cgPC0gZnVuY3Rpb24oc2VlZD0xOTk2LCBjZW50ZXIgPSBjKDAsMCksIHdpZHRoPTUsXG4gICAgICAgICAgICAgICAgICAgICAgZHggPSAwLjEsIGR5PTAuMSwgbmdyaWQ9MzEsIGFycm93PTEpIHtcbiAgeHJhbmdlIDwtIGNlbnRlclsxXSArIHdpZHRoKmMoLTEsMSlcbiAgeXJhbmdlIDwtIGNlbnRlclsyXSArIHdpZHRoKmMoLTEsMSlcbiAgR3JpZCA8LSBleHBhbmQuZ3JpZCh4PXNlcSh4cmFuZ2VbMV0sIHhyYW5nZVsyXSwgbGVuZ3RoPW5ncmlkKSxcbiAgICAgICAgICAgICAgICAgICAgICB5PXNlcSh5cmFuZ2VbMV0sIHlyYW5nZVsyXSwgIGxlbmd0aD1uZ3JpZCkpXG4gICMgVGhpcyBvbmUgaXMgYWx3YXlzIHRoZSBzYW1lLCBzbyB6b29taW5nIGluIHdpbGwgd29ya1xuICBHcmlkMiA8LSBleHBhbmQuZ3JpZCh4ID0gc2VxKC03LCA3KSwgeSA9IHNlcSgtNywgNykpXG4gIGRvbSA8LSBkb21haW4oeD0hIXhyYW5nZSwgeT0hIXlyYW5nZSlcbiAgeHJhdyA8LSBkb29kbGVfZnVuKH4geCArIHksIHNlZWQgPSBzZWVkKVxuICB5cmF3IDwtIGRvb2RsZV9mdW4ofiB4ICsgeSwgc2VlZCA9IHNlZWQgKyAxKVxuICBTdGF0cyA8LSBHcmlkMiB8PlxuICAgIG11dGF0ZSh4dmFscyA9IHhyYXcoeCx5KSxcbiAgICAgICAgICAgeXZhbHMgPSB5cmF3KHgseSkpIHw+XG4gICAgc3VtbWFyaXplKG1pZHggPSBtZWFuKHh2YWxzKSwgbWlkeSA9IG1lYW4oeXZhbHMpLFxuICAgICAgICAgICAgICBzZHggPSBzZCh4dmFscyksIHNkeSA9IHNkKHl2YWxzKSlcblxuICB4ZnVuIDwtIGZ1bmN0aW9uKHgsIHkpIHggKyBkeCooeHJhdyh4LHkpLVN0YXRzJG1pZHgpL1N0YXRzJHNkeFxuICB5ZnVuIDwtIGZ1bmN0aW9uKHgsIHkpIHkgKyBkeSooeXJhdyh4LHkpLVN0YXRzJG1pZHkpL1N0YXRzJHNkeVxuICBBcnJvd3MgPC0gR3JpZCB8PlxuICAgIG11dGF0ZSh4ZW5kID0geGZ1bih4LHkpLCB5ZW5kPXlmdW4oeCx5KSlcbiAgY29udG91cl9wbG90KHhmdW4oeCx5KSAtIHggfiB4ICsgeSwgZG9tYWluPWRvbSxcbiAgICAgICAgICAgICAgIGNvbnRvdXJfY29sb3I9XCJkb2RnZXJibHVlXCIsIGNvbnRvdXJzX2F0ID0gYygwKSxcbiAgICAgICAgICAgICAgIHNraXA9MCwgbGFiZWxzPUZBTFNFKSB8PlxuICAgIGNvbnRvdXJfcGxvdCh5ZnVuKHgseSkgLSB5IH4geCArIHksXG4gICAgICAgICAgICAgICAgIGNvbnRvdXJfY29sb3I9XCJvcmFuZ2UzXCIsIGNvbnRvdXJzX2F0ID0gYygwKSxcbiAgICAgICAgICAgICAgICAgc2tpcD0wLCBmaWxsZWQ9RkFMU0UsIGxhYmVscz1GQUxTRSkgfD5cbiAgICBnZl9zZWdtZW50KHkgKyB5ZW5kIH4geCArIHhlbmQsIGRhdGEgPSBBcnJvd3MsIHNpemU9YXJyb3cqMC41KSB8PlxuICAgIGdmX3BvaW50KHllbmQgfiB4ZW5kLCBkYXRhID0gQXJyb3dzLCBzaXplID0gYXJyb3csIGFscGhhPTAuMykgfD5cbiAgICBnZl9yZWZpbmUoY29vcmRfZml4ZWQoKSlcbn0ifQ==
</script>
</div>
</div>
</div>
</div>
<p>The task of this modeling project is to construct a ranking of students based on their grades over a college career.</p>
<p>The data come from a small college in the US Midwest. For reasons of anonymity, student names have been replace with unique meaningless ID codes, with all the courses taken by a student and the grades received identified by that student’s code. Similarly, the instructor and department indentities are encoded. Also, only about half of the courses taken by each student are included. The students listed graduated in AY 2004/2005.</p>
<p>The data were originally in the form of three data frames in a relational database. We use data wrangling to merge them into a single data <code>Events</code> frame where the unit of observation is an event consisting of a single student receiving a grade in a single course.</p>
<div class="cell" data-caption="Assembling the data">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>Events <span class="ot">&lt;-</span> LSTbook<span class="sc">::</span>Grades <span class="sc">|&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(LSTbook<span class="sc">::</span>Sessions) <span class="sc">|&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(LSTbook<span class="sc">::</span>Gradepoint)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To orient you to the variables and their meanings, here are five randomly selected events:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Events <span class="sc">|&gt;</span> <span class="fu">take_sample</span>(<span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  grade   sessionID    sid     iid enroll dept level    sem gradepoint
1    B+ session2757 S32268 inst488     64    m   100 SP2003       3.33
2    A- session3257 S31908 inst312     16    o   200 SP2004       3.66
3    C- session2546 S31824 inst483     37    m   100 FA2002       1.66
4     A session3137 S31665 inst257     23    M   300 SP2004       4.00
5    A- session3814 S31659 inst372     18    W   200 SP2005       3.66</code></pre>
</div>
</div>
<p>The <code>gradepoint</code> variable is the numerical equivalent of the letter <code>grade</code>.</p>
<p>One oddity of the data is that, for a few students, courses were taken some years before the rest of the cohort. Let’s wrangle up the distribution of semesters:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Semesters <span class="ot">&lt;-</span> Events <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sem =</span> <span class="fu">gsub</span>(<span class="st">"S(1|2)"</span>, <span class="st">"SP"</span>, sem)) <span class="sc">|&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">takers =</span> <span class="fu">n</span>(), <span class="at">.by =</span> sem) <span class="sc">|&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(takers)) <span class="sc">|&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">keep =</span> <span class="fu">ifelse</span>(takers <span class="sc">&gt;</span> <span class="dv">400</span>, <span class="st">"keep"</span>, <span class="st">"rid"</span>))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>Semesters</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      sem takers keep
1  FA2002    890 keep
2  FA2003    867 keep
3  FA2001    826 keep
4  SP2002    803 keep
5  SP2003    775 keep
6  FA2004    754 keep
7  SP2005    629 keep
8  SP2004    497 keep
9  SP2001     31  rid
10 FA2000     27  rid
11 SP2000      7  rid
12 FA1999      6  rid
13 FA1993      3  rid
14 FA1991      2  rid
15 SP1997      2  rid
16 SP1998      2  rid
17 FA1997      1  rid
18 IT1994      1  rid
19 SP1994      1  rid</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
For Statistical Modeling students
</div>
</div>
<div class="callout-body-container callout-body">
<p>Join <code>Semesters</code> with <code>Events</code>. Use it to remove <strong>students</strong> who took any course outside of the most populated 8 semesters.</p>
<div class="cell" data-caption="Remove underpopulated semester">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Events <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(Semesters <span class="sc">|&gt;</span> <span class="fu">select</span>(sem, keep)) <span class="sc">|&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(keep <span class="sc">==</span> <span class="st">"keep"</span>) <span class="ot">-&gt;</span> Goo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(sem)`</code></pre>
</div>
</div>
<p>But really I want to remove <em>students</em>, not just the courses they took in off semesters.</p>
<div class="cell" data-caption="Remove underpopulated semester">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Events <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(Semesters <span class="sc">|&gt;</span> <span class="fu">select</span>(sem, keep)) <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">all</span>(keep <span class="sc">==</span> <span class="st">"keep"</span>), <span class="at">.by =</span> sid) <span class="ot">-&gt;</span> Goo2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(sem)`</code></pre>
</div>
</div>
</div>
</div>
<section id="ranking-with-gpa" class="level2">
<h2 class="anchored" data-anchor-id="ranking-with-gpa">Ranking with GPA</h2>
<p>Most students are familiar with the GPA and its use in ranking students. Here’s the calculation written in the <code>{dplyr}</code> notation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>GPA <span class="ot">&lt;-</span> Events <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">gpa_raw =</span> <span class="fu">mean</span>(gradepoint, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.by =</span> sid)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>GPA <span class="sc">|&gt;</span> <span class="fu">take_sample</span>(<span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     sid  gpa_raw
1 S31308 3.046923
2 S31692 3.163750
3 S31518 3.975714
4 S31614 3.641875
5 S31929 3.210000</code></pre>
</div>
</div>
<p>To be statistically literate, such an estimate of the GPA should come with a confidence interval. We’ll calculate the margin of error using stardard textbook formulas. In calculating the margin of error, I’ll artificially <em>double</em> the <span class="math inline">\(n\)</span> for each student so that we get the magnitude of standard errors we would expect to see if we had <em>all</em> the student-grade records.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>GPA <span class="ot">&lt;-</span> Events <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">gpa_raw =</span> <span class="fu">mean</span>(gradepoint, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">gp_var =</span> <span class="fu">var</span>(gradepoint, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">gp_me =</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(gp_var <span class="sc">/</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">n</span>()),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">.lwr =</span> gpa_raw <span class="sc">-</span> gp_me,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">.upr =</span> gpa_raw <span class="sc">+</span> gp_me,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">.by =</span> sid) <span class="sc">|&gt;</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sid, .lwr, gpa_raw, .upr)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>GPA <span class="sc">|&gt;</span> <span class="fu">take_sample</span>(<span class="at">n=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     sid       .lwr  gpa_raw     .upr
1 S31788  2.0096387 3.586154 5.162669
2 S31320 -0.4782222 3.330769 7.139761
3 S31911  3.2949788 3.943333 4.591688
4 S31974  0.5335102 3.286000 6.038490
5 S32166  2.1837721 3.719167 5.254561</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>GPA <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(gpa_raw) <span class="sc">|&gt;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_segment</span>(.lwr <span class="sc">+</span> .upr <span class="sc">~</span> rank <span class="sc">+</span> rank) <span class="sc">|&gt;</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_point</span>(gpa_raw <span class="sc">~</span> rank, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size=</span><span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index-grades_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can do much the same calculation by modeling, but we’ll have to “adjust” the confidence intervals by hand to mimic data with the full collection of grades.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>GPA2 <span class="ot">&lt;-</span> Events <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_train</span>(gradepoint <span class="sc">~</span> sid) <span class="sc">|&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_eval</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">sid =</span> <span class="fu">unique</span>(Events<span class="sc">$</span>sid)), <span class="at">interval =</span> <span class="st">"confidence"</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.lwr =</span> .output <span class="sc">-</span> (.output <span class="sc">-</span> .lwr)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span>), <span class="at">.upr =</span> .output <span class="sc">+</span> (.upr <span class="sc">-</span> .output)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span>))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>GPA2 <span class="sc">|&gt;</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">take_sample</span>(<span class="at">n=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  sid     .lwr .output  .upr
  &lt;chr&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 S31932  2.67    2.87  3.06
2 S31473  3.24    3.48  3.71
3 S32019  2.47    2.66  2.86
4 S31584  3.21    3.41  3.60
5 S32253  3.71    3.89  4.07</code></pre>
</div>
</div>
<p>Compare GPA with GPA2:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Compare <span class="ot">&lt;-</span> GPA <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sid, gpa_raw) <span class="sc">|&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gpa2 =</span> GPA2<span class="sc">$</span>.output)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>Compare <span class="sc">|&gt;</span> <span class="fu">point_plot</span>(gpa_raw <span class="sc">~</span> gpa2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index-grades_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why don’t they …?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let’s speculate on why registrars don’t report a GPA with a confidence interval.</p>
</div>
</div>
</section>
<section id="what-about-the-covariates" class="level2">
<h2 class="anchored" data-anchor-id="what-about-the-covariates">What about the covariates</h2>
<p>TASK: Add in some covariates: semester, class level, class size</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>GPA3 <span class="ot">&lt;-</span> Events <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_train</span>(gradepoint <span class="sc">~</span> sid <span class="sc">+</span> enroll <span class="sc">+</span> level <span class="sc">+</span> sem) <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_eval</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">sid =</span> <span class="fu">unique</span>(Events<span class="sc">$</span>sid), </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sem=</span><span class="st">"SP2005"</span>, <span class="at">level=</span><span class="dv">300</span>, <span class="at">enroll=</span><span class="dv">12</span>), </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">interval =</span> <span class="st">"confidence"</span>) <span class="sc">|&gt;</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.lwr =</span> .output <span class="sc">-</span> (.output <span class="sc">-</span> .lwr)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span>), </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">.upr =</span> .output <span class="sc">+</span> (.upr <span class="sc">-</span> .output)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span>))</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>GPA3 <span class="sc">|&gt;</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">take_sample</span>(<span class="at">n=</span><span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sid, .lwr, .output, .upr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  sid     .lwr .output  .upr
  &lt;chr&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 S31932  2.80    2.99  3.19
2 S31473  3.39    3.63  3.86
3 S32019  2.61    2.81  3.00
4 S31584  3.37    3.56  3.76
5 S32253  3.85    4.03  4.21</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>Compare <span class="ot">&lt;-</span> Compare <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gpa3 =</span> GPA3<span class="sc">$</span>.output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s look at the extent to which <code>dept</code> or <code>instructor</code> plays a role:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>Events <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_train</span>(gradepoint <span class="sc">~</span> enroll <span class="sc">+</span> level <span class="sc">+</span> sem <span class="sc">+</span> dept <span class="sc">+</span> iid <span class="sc">+</span> sid) <span class="sc">|&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova_summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 6
  term         df   sumsq meansq statistic    p.value
  &lt;chr&gt;     &lt;int&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
1 enroll        1    8.42  8.42      40.3   2.33e- 10
2 level         1    6.72  6.72      32.2   1.49e-  8
3 sem          24   53.2   2.21      10.6   3.02e- 39
4 dept         38  115.    3.04      14.5   4.74e- 87
5 iid         345  231.    0.671      3.21  9.52e- 70
6 sid         442  586.    1.33       6.35  1.33e-249
7 Residuals  4838 1010.    0.209     NA    NA        </code></pre>
</div>
</div>
<p>And find the “instructor-adjusted” GPA:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>GPA4 <span class="ot">&lt;-</span> Events <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_train</span>(gradepoint <span class="sc">~</span> sid <span class="sc">+</span> enroll <span class="sc">+</span> level <span class="sc">+</span> sem <span class="sc">+</span> dept) <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_eval</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">sid =</span> <span class="fu">unique</span>(Events<span class="sc">$</span>sid), </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sem=</span><span class="st">"SP2005"</span>, <span class="at">level=</span><span class="dv">300</span>, <span class="at">enroll=</span><span class="dv">12</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iid =</span> <span class="st">"inst436"</span>, <span class="at">dept =</span> <span class="st">"q"</span>), </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">interval =</span> <span class="st">"confidence"</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.lwr =</span> .output <span class="sc">-</span> (.output <span class="sc">-</span> .lwr)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span>), </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">.upr =</span> .output <span class="sc">+</span> (.upr <span class="sc">-</span> .output)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>Compare <span class="ot">&lt;-</span> Compare <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gpa4 =</span> GPA4<span class="sc">$</span>.output) <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">r_gpa_raw =</span> <span class="fu">rank</span>(gpa_raw),</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">r_gpa3 =</span> <span class="fu">rank</span>(gpa3),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">r_gpa4 =</span> <span class="fu">rank</span>(gpa4))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>How do the adjusted models agree with the “raw” gpa</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>Compare <span class="sc">|&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">point_plot</span>(r_gpa3 <span class="sc">~</span> r_gpa_raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index-grades_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>Compare <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">point_plot</span>(r_gpa4 <span class="sc">~</span> r_gpa_raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index-grades_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>How well do the two “adjusted” models agree?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>Compare <span class="sc">|&gt;</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">point_plot</span>(r_gpa3 <span class="sc">~</span> r_gpa4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index-grades_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="a-political-problem" class="level2">
<h2 class="anchored" data-anchor-id="a-political-problem">A political problem</h2>
<p>The registrar would never perform such a regression. The political heat from the faculty would be too great.</p>
<p>Can we construct a ranking that uses only <code>sid</code>, <code>session</code>, and <code>gradepoint</code>? That will let us avoid</p>
<p>How many students did each instructor teach?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>nstudents <span class="ot">&lt;-</span> Events <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.by =</span> iid) <span class="sc">|&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s look only at instructors with more than 10 students.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>Keepers <span class="ot">&lt;-</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  nstudents <span class="sc">|&gt;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(count <span class="sc">&gt;</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(Events)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(iid)`</code></pre>
</div>
</div>
</section>
<section id="method" class="level2">
<h2 class="anchored" data-anchor-id="method">Method</h2>
<p><a href="https://maherou.github.io/Teaching/files/CS317/masseyMethod.pdf" class="uri">https://maherou.github.io/Teaching/files/CS317/masseyMethod.pdf</a></p>
</section>
<section id="trying-again" class="level2">
<h2 class="anchored" data-anchor-id="trying-again">Trying again</h2>
<p>Compare all pairs of students in a session.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>for_one_session <span class="ot">&lt;-</span> <span class="cf">function</span>(this_session) {</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  Roster <span class="ot">&lt;-</span> Events <span class="sc">|&gt;</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(sessionID <span class="sc">==</span> this_session) <span class="sc">|&gt;</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(sid, gradepoint)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  P1 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(Roster<span class="sc">$</span>sid, Roster<span class="sc">$</span>sid)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  P2 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(Roster<span class="sc">$</span>gradepoint, Roster<span class="sc">$</span>gradepoint)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(P1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sid"</span>, <span class="st">"sid2"</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(P2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gp1"</span>, <span class="st">"gp2"</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(P1, P2) <span class="sc">|&gt;</span> </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">gp3 =</span> gp1 <span class="sc">-</span> gp2) <span class="sc">|&gt;</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(gp3 <span class="sc">&gt;</span> <span class="dv">0</span>) </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>Sessions <span class="ot">&lt;-</span> Events <span class="sc">|&gt;</span> </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sessionID, enroll) <span class="sc">|&gt;</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(enroll <span class="sc">&gt;</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, <span class="at">.by =</span> sessionID) </span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>Snames <span class="ot">&lt;-</span> <span class="fu">as.list</span>(Sessions<span class="sc">$</span>sessionID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>Rosters <span class="ot">&lt;-</span> <span class="fu">lapply</span>(Snames, </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">for_one_session</span>(x)) <span class="sc">|&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>() <span class="sc">|&gt;</span> </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sid =</span> <span class="fu">as.character</span>(sid), <span class="at">sid2 =</span> <span class="fu">as.character</span>(sid2)) <span class="sc">|&gt;</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">competition =</span> <span class="fu">row_number</span>())</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>student_index2 <span class="ot">&lt;-</span> student_index <span class="ot">&lt;-</span> </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sid =</span> <span class="fu">unique</span>(<span class="fu">c</span>(Rosters<span class="sc">$</span>sid, Rosters<span class="sc">$</span>sid2))) <span class="sc">|&gt;</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sindex =</span> <span class="fu">row_number</span>())</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(student_index2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sid2"</span>, <span class="st">"sindex2"</span>)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>Rosters <span class="ot">&lt;-</span> Rosters <span class="sc">|&gt;</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(student_index) <span class="sc">|&gt;</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(student_index2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(sid)`
Joining with `by = join_by(sid2)`</code></pre>
</div>
</div>
</section>
<section id="fill-in-the-matrix-for-each-competition" class="level2">
<h2 class="anchored" data-anchor-id="fill-in-the-matrix-for-each-competition">Fill in the matrix for each competition</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>compete_M <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">ncol =</span> <span class="fu">nrow</span>(student_index), <span class="at">nrow =</span> <span class="fu">nrow</span>(Rosters))</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>RC <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Rosters<span class="sc">$</span>competition, Rosters<span class="sc">$</span>sindex)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>compete_M[RC] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>RC2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Rosters<span class="sc">$</span>competition, Rosters<span class="sc">$</span>sindex2)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>compete_M[RC2] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>compete_M[<span class="fu">nrow</span>(compete_M), ] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co"># how many redundant vectors</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">svd</span>(compete_M)<span class="sc">$</span>d <span class="sc">&gt;</span> <span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
TRUE 
 442 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">qr.solve</span>(compete_M[,<span class="dv">1</span><span class="sc">:</span><span class="dv">442</span>], Rosters<span class="sc">$</span>gp3)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>Rankings <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">score =</span> foo) <span class="sc">|&gt;</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(student_index) <span class="sc">|&gt;</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rscore =</span> <span class="fu">rank</span>(score)) <span class="sc">|&gt;</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(rscore)) <span class="sc">|&gt;</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(GPA) <span class="sc">|&gt;</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sid, rscore, gpa_raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(sid)`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>Rankings <span class="sc">|&gt;</span> <span class="fu">point_plot</span>(rscore <span class="sc">~</span> gpa_raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index-grades_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Look at special cases, such as S31254 who had a perfect GPA but low rank in the class. Is this because s/he won competitions narrowly with students with a low rank.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>RR <span class="ot">&lt;-</span> Rosters <span class="sc">|&gt;</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(Rankings) <span class="sc">|&gt;</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(Rankings, <span class="at">by =</span> <span class="fu">join_by</span>(sid2  <span class="sc">==</span> sid))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(sid)`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>RR <span class="sc">|&gt;</span> <span class="fu">filter</span>(sid <span class="sc">==</span> <span class="st">"S31254"</span>) <span class="ot">-&gt;</span> hoo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Or look at the two people with high rank but GPA near 3.0.</p>
<p>Compare the departments in which people of low rank took courses compared to high rank.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>Bottom <span class="ot">&lt;-</span> Rankings <span class="sc">|&gt;</span> <span class="fu">filter</span>(rscore <span class="sc">&lt;</span> <span class="dv">100</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>Low <span class="ot">&lt;-</span> Events <span class="sc">|&gt;</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sid <span class="sc">%in%</span> Bottom<span class="sc">$</span>sid) <span class="sc">|&gt;</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">bottom_count =</span> <span class="fu">n</span>(), <span class="at">.by =</span> dept)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>Top <span class="ot">&lt;-</span> Rankings <span class="sc">|&gt;</span> <span class="fu">filter</span>(rscore <span class="sc">&gt;</span> <span class="dv">375</span>) </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>High <span class="ot">&lt;-</span> Events <span class="sc">|&gt;</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sid <span class="sc">%in%</span> Top<span class="sc">$</span>sid) <span class="sc">|&gt;</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">top_count =</span> <span class="fu">n</span>(), <span class="at">.by =</span> dept)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>Together <span class="ot">&lt;-</span> Low <span class="sc">|&gt;</span> <span class="fu">full_join</span>(High)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(dept)`</code></pre>
</div>
</div>
<p>Look at <code>Together</code> to see whether students have the same distribution of departments.</p>
</section>
<section id="sat-scores-and-academic-performance" class="level2">
<h2 class="anchored" data-anchor-id="sat-scores-and-academic-performance">SAT scores and academic performance</h2>
<p>The College Board claims that the predictive power of the SAT on (first-year) college performance corresponds to <span class="math inline">\(r \approx 0.40\)</span>.</p>
<p>To visualize what this means, let’s construct 10,000 pairs of SAT versus UATX performance that have this correlation and look at the rank of each student by both measures.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>Simulation <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">common =</span> <span class="fl">0.4</span> <span class="sc">*</span> <span class="fu">rnorm</span>(n),</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">UATX =</span> common <span class="sc">+</span> <span class="fl">0.47</span> <span class="sc">*</span> <span class="fu">rnorm</span>(n),</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">SAT =</span> common <span class="sc">+</span> <span class="fl">0.47</span> <span class="sc">*</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>Simulation <span class="sc">|&gt;</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_train</span>(UATX <span class="sc">~</span> SAT) <span class="sc">|&gt;</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">R2</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      n k Rsquared        F     adjR2 p df.num df.denom
1 10000 1 0.175413 2126.858 0.1753306 0      1     9998</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>Simulation <span class="sc">|&gt;</span> <span class="fu">point_plot</span>(<span class="fu">rank</span>(UATX) <span class="sc">~</span> <span class="fu">rank</span>(SAT))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index-grades_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Perhaps a better intuition can be had by imagining 200 applicants and looking at the performace of those in the top half of the SAT versus those in the bottom half.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>Simulation <span class="sc">|&gt;</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sat_position =</span> <span class="fu">ifelse</span>(<span class="fu">rank</span>(SAT) <span class="sc">&gt;</span> n<span class="sc">/</span><span class="dv">2</span>, <span class="st">"top"</span>, <span class="st">"bottom"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">take_sample</span>(<span class="at">n =</span> <span class="dv">200</span>) <span class="sc">|&gt;</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">point_plot</span>(<span class="fu">rank</span>(UATX) <span class="sc">~</span> sat_position, <span class="at">annot =</span> <span class="st">"model"</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">point_ink =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index-grades_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


<script type="webr-data">
eyJvcHRpb25zIjp7ImJhc2VVcmwiOiJodHRwczovL3dlYnIuci13YXNtLm9yZy92MC40LjIvIn0sInBhY2thZ2VzIjp7InBrZ3MiOlsiZXZhbHVhdGUiLCJrbml0ciIsImh0bWx0b29scyIsIm1vc2FpY0NhbGMiLCJnZ3Bsb3QyIiwiZ2dmb3JtdWxhIl0sInJlcG9zIjpbImh0dHBzOi8vZHRrYXBsYW4uci11bml2ZXJzZS5kZXYiXX0sInJlbmRlcl9kZiI6ImRlZmF1bHQifQ==
</script>
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3siY2VsbE5hbWUiOiJ3ZWJyLXdpZGdldC0xIiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoie1xuICAvLyBXYWl0IGZvciBvdXRwdXQgdG8gYmUgd3JpdHRlbiB0byB0aGUgRE9NLCB0aGVuIHRyaWdnZXIgd2lkZ2V0IHJlbmRlcmluZ1xuICBhd2FpdCBfd2Vicl92YWx1ZV8xO1xuICBpZiAod2luZG93LkhUTUxXaWRnZXRzKSB7XG4gICAgd2luZG93LkhUTUxXaWRnZXRzLnN0YXRpY1JlbmRlcigpO1xuICB9XG4gIGlmICh3aW5kb3cuUGFnZWRUYWJsZURvYykge1xuICAgIHdpbmRvdy5QYWdlZFRhYmxlRG9jLmluaXRBbGwoKTtcbiAgfVxufVxuIn0seyJjZWxsTmFtZSI6IndlYnItMSIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJzb3VyY2UiOiJ2aWV3b2YgX3dlYnJfZWRpdG9yXzEgPSB7XG4gIGNvbnN0IHsgV2ViUkV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwid2Vici0xLWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHdlYnItMS1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBXZWJSRXhlcmNpc2VFZGl0b3Iod2ViUk9qcy53ZWJSUHJvbWlzZSwgYmxvY2suY29kZSwgb3B0aW9ucyk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fd2Vicl92YWx1ZV8xID0gd2ViUk9qcy5wcm9jZXNzKF93ZWJyX2VkaXRvcl8xLCB7fSk7XG4ifSx7ImNlbGxOYW1lIjoid2Vici1wcmVsdWRlIiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoid2ViUk9qcyA9IHtcbiAgY29uc3QgeyBXZWJSLCBDaGFubmVsVHlwZSB9ID0gd2luZG93Ll9leGVyY2lzZV9vanNfcnVudGltZS5XZWJSO1xuICBjb25zdCB7XG4gICAgV2ViUkV2YWx1YXRvcixcbiAgICBXZWJSRW52aXJvbm1lbnRNYW5hZ2VyLFxuICAgIHNldHVwUixcbiAgICBiNjREZWNvZGUsXG4gICAgY29sbGFwc2VQYXRoXG4gIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHN0YXR1c0NvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZXhlcmNpc2UtbG9hZGluZy1zdGF0dXNcIik7XG4gIGNvbnN0IGluZGljYXRvckNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZXhlcmNpc2UtbG9hZGluZy1pbmRpY2F0b3JcIik7XG4gIGluZGljYXRvckNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwiZC1ub25lXCIpO1xuXG4gIGxldCBzdGF0dXNUZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKVxuICBzdGF0dXNUZXh0LmNsYXNzTGlzdCA9IFwiZXhlcmNpc2UtbG9hZGluZy1kZXRhaWxzXCI7XG4gIHN0YXR1c1RleHQgPSBzdGF0dXNDb250YWluZXIuYXBwZW5kQ2hpbGQoc3RhdHVzVGV4dCk7XG4gIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBgSW5pdGlhbGlzZWA7XG5cbiAgLy8gSG9pc3QgaW5kaWNhdG9yIG91dCBmcm9tIGZpbmFsIHNsaWRlIHdoZW4gcnVubmluZyB1bmRlciByZXZlYWxcbiAgY29uc3QgcmV2ZWFsU3RhdHVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5yZXZlYWwgLmV4ZXJjaXNlLWxvYWRpbmctaW5kaWNhdG9yXCIpO1xuICBpZiAocmV2ZWFsU3RhdHVzKSB7XG4gICAgcmV2ZWFsU3RhdHVzLnJlbW92ZSgpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucmV2ZWFsID4gLnNsaWRlc1wiKS5hcHBlbmRDaGlsZChyZXZlYWxTdGF0dXMpO1xuICB9XG5cbiAgLy8gTWFrZSBhbnkgcmV2ZWFsIHNsaWRlcyB3aXRoIGxpdmUgY2VsbHMgc2Nyb2xsYWJsZVxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnJldmVhbCAuZXhlcmNpc2UtY2VsbFwiKS5mb3JFYWNoKChlbCkgPT4ge1xuICAgIGVsLmNsb3Nlc3QoJ3NlY3Rpb24uc2xpZGUnKS5jbGFzc0xpc3QuYWRkKFwic2Nyb2xsYWJsZVwiKTtcbiAgfSlcblxuICAvLyB3ZWJSIHN1cHBsZW1lbnRhbCBkYXRhIGFuZCBvcHRpb25zXG4gIGNvbnN0IGRhdGFDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcIndlYnItZGF0YVxcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKGI2NERlY29kZShkYXRhQ29udGVudCkpO1xuXG4gIC8vIEdyYWIgbGlzdCBvZiByZXNvdXJjZXMgdG8gYmUgZG93bmxvYWRlZFxuICBjb25zdCBmaWxlc0NvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwidmZzLWZpbGVcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBmaWxlcyA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKGZpbGVzQ29udGVudCkpO1xuXG4gIC8vIFVzZSBQb3N0TWVzc2FnZSBjaGFubmVsIGZvciBhc3luYyBjb21tdW5pY2F0aW9uXG4gIC8vIFdlIGRvIG5vdCBleHBlY3QgdG8gdGFrZSBuZXN0ZWQgcHJvbXB0IGlucHV0IGluIFF1YXJ0byBMaXZlIGNlbGxzXG4gIGRhdGEub3B0aW9ucy5jaGFubmVsVHlwZSA9IENoYW5uZWxUeXBlLlBvc3RNZXNzYWdlO1xuXG4gIC8vIEluaXRpYWxpc2Ugd2ViUiBhbmQgc2V0dXAgZm9yIFIgY29kZSBldmFsdWF0aW9uXG4gIGxldCB3ZWJSUHJvbWlzZSA9IChhc3luYyAod2ViUikgPT4ge1xuICAgIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBgRG93bmxvYWRpbmcgd2ViUmA7XG4gICAgYXdhaXQgd2ViUi5pbml0KCk7XG5cbiAgICAvLyBJbnN0YWxsIHByb3ZpZGVkIGxpc3Qgb2YgcGFja2FnZXNcbiAgICAvLyBFbnN1cmUgd2ViUiBkZWZhdWx0IHJlcG8gaXMgaW5jbHVkZWRcbiAgICBkYXRhLnBhY2thZ2VzLnJlcG9zLnB1c2goXCJodHRwczovL3JlcG8uci13YXNtLm9yZ1wiKVxuICAgIGF3YWl0IGRhdGEucGFja2FnZXMucGtncy5tYXAoKHBrZykgPT4gKCkgPT4ge1xuICAgICAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IGBEb3dubG9hZGluZyBwYWNrYWdlOiAke3BrZ31gO1xuICAgICAgcmV0dXJuIHdlYlIuZXZhbFJWb2lkKGBcbiAgICAgICAgd2Vicjo6aW5zdGFsbChwa2csIHJlcG9zID0gcmVwb3MpXG4gICAgICAgIGxpYnJhcnkocGtnLCBjaGFyYWN0ZXIub25seSA9IFRSVUUpXG4gICAgICBgLCB7IGVudjoge1xuICAgICAgICBwa2c6IHBrZyxcbiAgICAgICAgcmVwb3M6IGRhdGEucGFja2FnZXMucmVwb3MsXG4gICAgICB9fSk7XG4gICAgfSkucmVkdWNlKChjdXIsIG5leHQpID0+IGN1ci50aGVuKG5leHQpLCBQcm9taXNlLnJlc29sdmUoKSk7XG5cbiAgICAvLyBEb3dubG9hZCBhbmQgaW5zdGFsbCByZXNvdXJjZXNcbiAgICBhd2FpdCBmaWxlcy5tYXAoKGZpbGUpID0+IGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG5hbWUgPSBmaWxlLnN1YnN0cmluZyhmaWxlLmxhc3RJbmRleE9mKCcvJykgKyAxKTtcbiAgICAgIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBgRG93bmxvYWRpbmcgcmVzb3VyY2U6ICR7bmFtZX1gO1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChmaWxlKTtcbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDYW4ndCBkb3dubG9hZCBcXGAke2ZpbGV9XFxgLiBFcnJvciAke3Jlc3BvbnNlLnN0YXR1c306IFwiJHtyZXNwb25zZS5zdGF0dXNUZXh0fVwiLmApO1xuICAgICAgfVxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmFycmF5QnVmZmVyKCk7XG5cbiAgICAgIC8vIFN0b3JlIFVSTHMgaW4gdGhlIGN3ZCB3aXRob3V0IGFueSBzdWJkaXJlY3Rvcnkgc3RydWN0dXJlXG4gICAgICBpZiAoZmlsZS5pbmNsdWRlcyhcIjovL1wiKSkge1xuICAgICAgICBmaWxlID0gbmFtZTtcbiAgICAgIH1cblxuICAgICAgLy8gQ29sbGFwc2UgaGlnaGVyIGRpcmVjdG9yeSBzdHJ1Y3R1cmVcbiAgICAgIGZpbGUgPSBjb2xsYXBzZVBhdGgoZmlsZSk7XG5cbiAgICAgIC8vIENyZWF0ZSBkaXJlY3RvcnkgdHJlZSwgaWdub3JpbmcgXCJkaXJlY3RvcnkgZXhpc3RzXCIgVkZTIGVycm9yc1xuICAgICAgY29uc3QgcGFydHMgPSBmaWxlLnNwbGl0KCcvJykuc2xpY2UoMCwgLTEpO1xuICAgICAgbGV0IHBhdGggPSAnJztcbiAgICAgIHdoaWxlIChwYXJ0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHBhdGggKz0gcGFydHMuc2hpZnQoKSArICcvJztcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCB3ZWJSLkZTLm1rZGlyKHBhdGgpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgaWYgKCFlLm1lc3NhZ2UuaW5jbHVkZXMoXCJGUyBlcnJvclwiKSkge1xuICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gV3JpdGUgdGhpcyBmaWxlIHRvIHRoZSBWRlNcbiAgICAgIHJldHVybiBhd2FpdCB3ZWJSLkZTLndyaXRlRmlsZShmaWxlLCBuZXcgVWludDhBcnJheShkYXRhKSk7XG4gICAgfSkucmVkdWNlKChjdXIsIG5leHQpID0+IGN1ci50aGVuKG5leHQpLCBQcm9taXNlLnJlc29sdmUoKSk7XG5cbiAgICBzdGF0dXNUZXh0LnRleHRDb250ZW50ID0gYEluc3RhbGxpbmcgd2ViUiBzaGltc2A7XG4gICAgYXdhaXQgd2ViUi5ldmFsUlZvaWQoYHdlYnI6OnNoaW1faW5zdGFsbCgpYCk7XG5cbiAgICBzdGF0dXNUZXh0LnRleHRDb250ZW50ID0gYFdlYlIgZW52aXJvbm1lbnQgc2V0dXBgO1xuICAgIGF3YWl0IHNldHVwUih3ZWJSLCBkYXRhKTtcblxuICAgIHN0YXR1c1RleHQucmVtb3ZlKCk7XG4gICAgaWYgKHN0YXR1c0NvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGggPT0gMCkge1xuICAgICAgc3RhdHVzQ29udGFpbmVyLnBhcmVudE5vZGUucmVtb3ZlKCk7XG4gICAgfVxuICAgIHJldHVybiB3ZWJSO1xuICB9KShuZXcgV2ViUihkYXRhLm9wdGlvbnMpKTtcblxuICAvLyBLZWVwIHRyYWNrIG9mIGluaXRpYWwgT0pTIGJsb2NrIHJlbmRlclxuICBjb25zdCByZW5kZXJlZE9qcyA9IHt9O1xuXG4gIGNvbnN0IHByb2Nlc3MgPSBhc3luYyAoY29udGV4dCwgaW5wdXRzKSA9PiB7XG4gICAgY29uc3Qgd2ViUiA9IGF3YWl0IHdlYlJQcm9taXNlO1xuICAgIGNvbnN0IGV2YWx1YXRvciA9IG5ldyBXZWJSRXZhbHVhdG9yKHdlYlIsIGNvbnRleHQpXG4gICAgYXdhaXQgZXZhbHVhdG9yLnByb2Nlc3MoaW5wdXRzKTtcbiAgICByZXR1cm4gZXZhbHVhdG9yLmNvbnRhaW5lcjtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgcHJvY2VzcyxcbiAgICB3ZWJSUHJvbWlzZSxcbiAgICByZW5kZXJlZE9qcyxcbiAgfTtcbn1cbiJ9XX0=
</script>
<div id="exercise-loading-indicator" class="exercise-loading-indicator d-none d-flex align-items-center gap-2">
<div id="exercise-loading-status" class="d-flex gap-2">

</div>
<div class="spinner-grow spinner-grow-sm">

</div>
</div>
<script type="vfs-file">
W10=
</script>
</section>

</main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W119
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../projects/Ranking-grades";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "../..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>